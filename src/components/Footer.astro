<section class="bg-white text-gray-700 py-2 rounded-tr-[100px]">
  <section id="contenedorEmpresas" class="flex flex-col gap-6 p-4 overflow-visible no-scrollbar relative w-full h-auto">
    
  </section>
</section>

<script>
  const URLBACK = import.meta.env.PUBLIC_BACKEND_URL || 'http://localhost'

  type Empresa = {
    id: number
    contenido: string
    imagen: string
  }

  document.addEventListener('DOMContentLoaded', () => {
    cargarEmpresas()
  })

  function orderCentered(arr: Empresa[]): Empresa[] {
    const result: Empresa[] = []
    const mid = Math.floor(arr.length / 2)
    if (arr.length === 0) return result
    result.push(arr[mid])
    let step = 1
    while (result.length < arr.length) {
      if (mid + step < arr.length) result.push(arr[mid + step])
      if (mid - step >= 0) result.push(arr[mid - step])
      step++
    }
    return result
  }

  function dividirEnGrupos<T>(array: T[], tam: number): T[][] {
    const result: T[][] = []
    for (let i = 0; i < array.length; i += tam) {
      result.push(array.slice(i, i + tam))
    }
    return result
  }

  async function cargarEmpresas(): Promise<Empresa[]> {
    const contenedor = document.getElementById('contenedorEmpresas')
    if (!contenedor) return []

    const response = await fetch(`${URLBACK}/company/`, {
      credentials: 'include'
    })
    if (!response.ok) throw new Error('Error al obtener las empresas')

    const empresas: Empresa[] = await response.json()

    const grid = document.createElement('div')
    grid.className =
      'grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-10 xl:grid-cols-10 gap-4 justify-items-center w-full px-4'

    empresas.forEach(emp => {
      grid.appendChild(crearCardEmpresa(emp))
    })

    contenedor.appendChild(grid)
  

    return empresas
  }

  function crearCardEmpresa(empresa: Empresa): HTMLElement {
    const a = document.createElement('a')
    a.href = empresa.contenido
    a.target = '_blank'
    a.rel = 'noopener noreferrer'
    a.className = 'w-[60px] h-auto flex-shrink-0 rounded-lg hover:scale-110 transition-transform duration-300 ease-in-out cursor-pointer'

    const img = document.createElement('img')
    img.src = empresa.imagen
    img.alt = 'imagen de empresa'
    img.className = 'w-full h-full object-contain rounded-lg'

    a.appendChild(img)
    return a
  }

</script>
